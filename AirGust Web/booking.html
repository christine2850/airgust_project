<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book a Service | AirGust</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" type="text/css" href="AirGust.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-container">
      <a class="navbar-brand" href="LandingPage.html">
        <img src="LogoW.png" alt="AirGust" />
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="LandingPage.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">About Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">Contact Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="services.html">Services</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="clients.html">Clients</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="booking.html">Book Now</a>
          </li>
        </ul>
      </div>
    </nav>

    <main class="main-content">
      <div class="container py-5">
        <h1 class="text-center mb-4">Book a Service</h1>
        <p class="text-center text-muted mb-5">
          Fill out the form below and we'll get back to you shortly.
        </p>

        <form
          id="bookingForm"
          class="mx-auto"
          style="max-width: 500px"
          novalidate
        >
          <div class="mb-3">
            <label for="fullName" class="form-label">Full Name</label>
            <input
              type="text"
              class="form-control"
              id="fullName"
              name="fullName"
              placeholder="Juan Dela Cruz"
              required
            />
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input
              type="email"
              class="form-control"
              id="email"
              name="email"
              placeholder="juan@example.com"
              required
            />
          </div>
          <div class="mb-3">
            <label for="contact" class="form-label">Contact No.</label>
            <input
              type="text"
              class="form-control"
              id="contact"
              name="contact"
              placeholder="09XX XXX XXXX"
              required
            />
          </div>
          <div class="mb-3">
            <label for="serviceType" class="form-label">Service</label>
            <select
              class="form-control"
              id="serviceType"
              name="serviceType"
              required
            >
              <option value="" disabled selected>Select service</option>
              <option value="AC Checkup">Air Conditioning Checkup</option>
              <option value="AC Repair">Air Conditioning Repair</option>
              <option value="AC Cleaning">Air Conditioning Cleaning</option>
              <option value="AC Installation">
                Air Conditioning Installation
              </option>
              <option value="Solar Panel Maintenance">
                Solar Panel Maintenance &amp; Repair
              </option>
              <option value="Solar Panel Cleaning">Solar Panel Cleaning</option>
              <option value="Solar Panel Installation">
                Solar Panel Installation
              </option>
              <option value="General">General Service</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="message" class="form-label">Message (optional)</label>
            <textarea
              class="form-control"
              id="message"
              name="message"
              rows="3"
              placeholder="Tell us about your needs..."
            ></textarea>
          </div>
          <div id="formMessage" class="mb-3" style="display: none"></div>
          <div class="d-grid">
            <button type="submit" class="btn-airgust btn-airgust-block">
              Submit Booking
            </button>
          </div>
        </form>

        <p class="text-center mt-4">
          For detailed Solar Panel Installation,
          <a href="SPIF.html">use this form</a>.
        </p>
      </div>
    </main>

    <footer class="footer-bg text-center mt-5">
      <div class="container p-4">
        <p class="text-white mb-0">&copy; AirGustPH</p>
      </div>
    </footer>

    <script>
      document
        .getElementById("bookingForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          const form = this;
          const formMessage = document.getElementById("formMessage");

          form.classList.add("was-validated");
          if (!form.checkValidity()) return;

          const data = Object.fromEntries(new FormData(form).entries());

          try {
            const res = await fetch(window.location.origin + "/api/bookings", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(data),
            });

            // Always show friendly thank-you message if request succeeds
            if (res.ok) {
              formMessage.style.display = "block";
              formMessage.className = "mb-3 alert alert-success";
              formMessage.textContent =
                "Thank you for submitting! Weâ€™ll get right back to you.";
              form.reset();
            } else {
              // In case server returns an error
              const result = await res.json();
              formMessage.style.display = "block";
              formMessage.className = "mb-3 alert alert-danger";
              formMessage.textContent =
                result.message || "Something went wrong. Please try again.";
            }
          } catch (err) {
            formMessage.style.display = "block";
            formMessage.className = "mb-3 alert alert-danger";
            formMessage.textContent =
              "Failed to submit. Is the server running?";
          }
        });
    </script>

    <script src="LandingPage.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
  </body>
</html>
